



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Technical documentation for the PROACTIS suite of products">
      
      
      
        <meta name="author" content="David Betteridge">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Single Sign On (SSO) - Technical Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#fb8c00">
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Arial","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#p2p-single-sign-on-sso" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Technical Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Technical Documentation
              </span>
              <span class="md-header-nav__topic">
                Single Sign On (SSO)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Technical Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="48" height="48">
      
    </a>
    Technical Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Invoice Capture" class="md-nav__link">
      Invoice Capture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Marketplace" class="md-nav__link">
      Marketplace
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      P2P
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        P2P
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../budgetchecking/" title="Budget Checking" class="md-nav__link">
      Budget Checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commitments/" title="Commitment Posting" class="md-nav__link">
      Commitment Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../applicationConfigurationSettings/" title="Application Configuration" class="md-nav__link">
      Application Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../help/" title="Online Help" class="md-nav__link">
      Online Help
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Imaging Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Imaging Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../genericimaging/" title="Generic Imaging" class="md-nav__link">
      Generic Imaging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../customimaging/" title="Custom Imaging" class="md-nav__link">
      Custom Imaging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../invoicePosting/" title="Invoice Posting" class="md-nav__link">
      Invoice Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Import APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Import APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../acceptanceGateway/" title="Acceptances" class="md-nav__link">
      Acceptances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cancelPurhaseOrderGateway/" title="Cancel Purchase Order" class="md-nav__link">
      Cancel Purchase Order
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../expensesGateway/" title="Expenses" class="md-nav__link">
      Expenses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internalInvoiceGateway/" title="Internal Invoices" class="md-nav__link">
      Internal Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../masterData/" title="Master Data" class="md-nav__link">
      Master Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseCreditNoteGateway/" title="Purchase Credit Notes" class="md-nav__link">
      Purchase Credit Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseInvoiceGateway/" title="Purchase Invoices" class="md-nav__link">
      Purchase Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseOrders/" title="Purchase Orders" class="md-nav__link">
      Purchase Orders
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../punchout/" title="PunchOut and Marketplaces" class="md-nav__link">
      PunchOut and Marketplaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nominalvalidation/" title="Nominal Validation" class="md-nav__link">
      Nominal Validation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Single Sign On (SSO)
      </label>
    
    <a href="./" title="Single Sign On (SSO)" class="md-nav__link md-nav__link--active">
      Single Sign On (SSO)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#windows-authentication" title="Windows Authentication" class="md-nav__link">
    Windows Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saml2" title="SAML2" class="md-nav__link">
    SAML2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external" title="External" class="md-nav__link">
    External
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bespoke" title="Bespoke" class="md-nav__link">
    Bespoke
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-messages" title="Return Messages" class="md-nav__link">
    Return Messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-11" type="checkbox" id="nav-3-11">
    
    <label class="md-nav__link" for="nav-3-11">
      Web site customisation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-11">
        Web site customisation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../addins/" title="Addins" class="md-nav__link">
      Addins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../customtab/" title="Custom Tabs" class="md-nav__link">
      Custom Tabs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Source to Contract
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Source to Contract
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/srm/" title="Supplier Management" class="md-nav__link">
      Supplier Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/contracts/" title="Contract Management" class="md-nav__link">
      Contract Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/sourcing/" title="Sourcing" class="md-nav__link">
      Sourcing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/users/" title="Users" class="md-nav__link">
      Users
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#windows-authentication" title="Windows Authentication" class="md-nav__link">
    Windows Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saml2" title="SAML2" class="md-nav__link">
    SAML2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external" title="External" class="md-nav__link">
    External
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bespoke" title="Bespoke" class="md-nav__link">
    Bespoke
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-messages" title="Return Messages" class="md-nav__link">
    Return Messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/proactis-documentation/ExampleApplications/edit/master/docs/p2p/sso.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="p2p-single-sign-on-sso">P2P Single-Sign-On (SSO)</h1>
<p>By default PROACTIS expects the users to enter their username and password in order to login into PROACTIS P2P.   This document lists the possible ways in which PROACTIS P2P can be configured to allow users to authenticate using Single-Sign-On.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you wish your users to use a combination of PROACTIS and SSO logins then add the following setting to the <strong>ApplicationConfiguration.xml</strong> file.</p>
</div>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;AllowPROACTISLogins&quot;</span><span class="nt">&gt;</span>True<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<hr />
<h2 id="windows-authentication">Windows Authentication</h2>
<p>If your PROACTIS P2P server is on the same domain as your users then the system can be configured so that they are automatically signed on without the need for them to re-enter their username and password.</p>
<ul>
<li>Ensure that Windows Authentication is enabled in IIS for your PROACTIS website</li>
</ul>
<p>It must first be installed as part of the <strong>Web Server</strong> role. </p>
<p><img alt="alt text" src="../../img/p2p/sso/iis_feature.JPG" title="ServerRole" /></p>
<p>And then enabled in the authentication section of your website</p>
<p><img alt="alt text" src="../../img/p2p/sso/iis_config.JPG" title="Config" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If some of your users aren't on your domain,  then leave anonymous authentication enabled for them.</p>
</div>
<ul>
<li>Add the following setting to the <strong>ApplicationConfiguration.xml</strong> file.</li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;AuthenticationMethod&quot;</span><span class="nt">&gt;</span>WINDOWS<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<ul>
<li>Set the <strong>NTLogon</strong> flag to True against the users,  and ensure that their usernames are in the format DOMAIN\Username.  <em>For example PROACTIS\DavidBetteridge</em></li>
</ul>
<hr />
<h2 id="saml2">SAML2</h2>
<p>PROACTIS P2P has built in support for SSO using the industry standard <a href="https://en.wikipedia.org/wiki/SAML_2.0">SAML2</a> protocol.</p>
<ul>
<li>First generate (or obtain) a local certificate and provide the public part of this to your identity provider.</li>
</ul>
<div class="codehilite"><pre><span></span>makecert -r -pe -n <span class="s2">&quot;CN=your_cert_name&quot;</span> -sky exchange -sv mycert.pvk mycert.cer

Enter yourPassword for the subject key (3 times!)

pvk2pfx.exe -pvk mycert.pvk -spc mycert.cer  -pi yourPassword -pfx mycert.pfx -po yourPassword
</pre></div>


<p>You will need to supply the identity provider with the public part of the generated certificate along with the path to the AssertionConsumerService which will be <strong>https://{server}/SystemLogon/AssertionConsumerService</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In order to use the SAML protocol your P2P website must be accessed using HTTPS not HTTP.</p>
</div>
<ul>
<li>With in your website's customer folder create a file called <strong>saml.config</strong>.   This should be based on the following template.</li>
</ul>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;SAMLConfiguration</span> <span class="na">xmlns=</span><span class="s">&quot;urn:componentspace:SAML:2.0:configuration&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;ServiceProvider</span> <span class="na">Name=</span><span class="s">&quot;service-provider-name&quot;</span>
                    <span class="na">AssertionConsumerServiceUrl=</span><span class="s">&quot;~/SystemLogon/AssertionConsumerService&quot;</span>
                    <span class="na">LocalCertificateFile=</span><span class="s">&quot;path-to-local-certificate-file&quot;</span>
                    <span class="na">LocalCertificatePassword=</span><span class="s">&quot;local-certificate-password&quot;</span><span class="nt">/&gt;</span>
 
 
   <span class="c">&lt;!-- ADFS --&gt;</span>
   <span class="nt">&lt;PartnerIdentityProviders&gt;</span>
      <span class="nt">&lt;PartnerIdentityProvider</span> <span class="na">Name=</span><span class="s">&quot;partner-identity-provider-name&quot;</span>
                <span class="na">Description=</span><span class="s">&quot;PROACTIS AD&quot;</span>
                               <span class="na">SignAuthnRequest=</span><span class="s">&quot;false&quot;</span>
                               <span class="na">WantSAMLResponseSigned=</span><span class="s">&quot;false&quot;</span>
                               <span class="na">WantAssertionSigned=</span><span class="s">&quot;true&quot;</span>
                               <span class="na">WantAssertionEncrypted=</span><span class="s">&quot;true&quot;</span>
                               <span class="na">PartnerCertificateFile=</span><span class="s">&quot;path-to-partner-certificate-file&quot;</span>
                               <span class="na">ClockSkew=</span><span class="s">&quot;00:03:00&quot;</span>
                               <span class="na">SingleSignOnServiceUrl=</span><span class="s">&quot;single-sign-on-service-url&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/PartnerIdentityProviders&gt;</span>
 
<span class="nt">&lt;/SAMLConfiguration&gt;</span>
</pre></div>


<ul>
<li>Add the following settings to your application.configuration file</li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;SSOAttributeName&quot;</span><span class="nt">&gt;</span>NameID<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<p>The name of the attribute containing the user identifier in the attributes list returned from the ADFS server.
If not specified then no attribute lookup is made and user identification is based on the “username” returned from the ADFS server.
 </p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;SSOAttributeNameMask&quot;</span><span class="nt">&gt;&lt;/Setting&gt;</span>
</pre></div>


<p>An optional mask to be applied to the above user identifier value.
 </p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;SSOMatchP2PUserOnEmailAddress&quot;</span><span class="nt">&gt;</span>False<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<p>By default, P2P searches the database Users table to find a user whose “LoginID” matches the identifier value returned from the ADFS server.
This optional setting will cause the lookup to be made on “EmailAddress” rather than “LoginID”
 </p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;SSODatabaseTitle&quot;</span><span class="nt">&gt;&lt;/Setting&gt;</span>
</pre></div>


<p>An optional setting that only applies when a user who is already logged into a 3rd party system, initiates a logon to P2P via SSO. In this scenario, the user is not 
presented with a logon page. If the user has access to multiple databases, then this setting specifies the database title (in the database xml file) to log into.
If this setting is not present, P2P will select the default database in the databases xml file (or the first database if no default).
Obviously if only one database is available, then this setting is unnecessary.</p>
<hr />
<h2 id="external">External</h2>
<p>By default PROACTIS P2P validates the username and password entered by the user against the record in the <strong>dsdba.Users</strong> table.   It is however possible to customise PROACTIS so that users are validated against an external userstore such as LDAP.</p>
<p>The following steps should be followed in order to create an external validation DLL.</p>
<ul>
<li>
<p>Create a new C# class library with a class called <strong>Services</strong> which implements the <strong>ILogin</strong> interface.  This interface can be found in <strong>PROACTIS.P2P.grsCustInterfaces.DLL</strong></p>
</li>
<li>
<p>Decide if your login process will be called asynchronously or not and implement the UseAsynchronousImplementation as required.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">UseAsynchronousImplementation</span> <span class="p">=&gt;</span> <span class="k">false</span><span class="p">;</span>
</pre></div>


<ul>
<li>
<p>Implement the <strong>Login</strong> (or <strong>LoginAsync</strong>) method with your custom validation code.  This method should return True for a successful login and False for a failure.  (For security reasons it is not possible to return messages informing the user why the login failed.  For example <em>the username does not exist</em>)</p>
</li>
<li>
<p>Compile your code,  and ensure that the resulting DLL is named xyzLogin.DLL.   (xyz can be anything)</p>
</li>
<li>
<p>Copy the DLL into your <strong>PROACTIS P2P/Plugins</strong>  (or <strong>Plugins/[database-title]</strong>) folder.</p>
</li>
<li>
<p>Add the following setting into your <strong>applicationconfiguration.xml</strong> file.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;AuthenticationMethod&quot;</span><span class="nt">&gt;</span>EXTERNAL<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<p>See the <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/SSO/PROACTIS.ExampleApplications.ExternalLogin">PROACTIS.ExampleApplications.ExternalLogin</a> example application for a complete sample implementation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>In order to login using the external DLL,  the user must have their NTLogon property set to True</li>
<li>Failed login attempts aren't recorded</li>
</ul>
</div>
<hr />
<h2 id="bespoke">Bespoke</h2>
<p>It is also possible to provide your users with a completely custom login process,  including replacing the login screen and adding the ability to automatically create users the first time they connect.</p>
<p>The process is to :</p>
<ul>
<li>
<p>Create a custom page in your website's customer folder called <strong>CustomLogin</strong></p>
</li>
<li>
<p>Within that page collect any required details from the user and validate their credentials.</p>
</li>
<li>
<p>If the user entered valid details then log them on by:</p>
<ul>
<li>First generating a unique token for them</li>
<li>Then writing the token to the <strong>DSDBA.CustomLoginTokens</strong> table.</li>
<li>Finally redirecting the user's browser to CustomLoginAsync within the main site.</li>
</ul>
</li>
<li>
<p>To enable your new page to be used,  the following settings should be added to the <strong>ApplicationConfiguration</strong> file.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;AuthenticationMethod&quot;</span><span class="nt">&gt;</span>CUSTOM<span class="nt">&lt;/Setting&gt;</span>
<span class="nt">&lt;Setting</span> <span class="na">Name=</span><span class="s">&quot;CustomLoginURL&quot;</span><span class="nt">&gt;</span>https://server/custom/CustomLogin.aspx<span class="nt">&lt;/Setting&gt;</span>
</pre></div>


<p>Where <em>server</em> is the address of your core P2P website.</p>
<p>See these <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/SSO/Bespoke">example pages</a> for a complete sample.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Upon exit from P2P, the browser will be redirected back to the custom login page with the following in the querystring <strong>action=logout</strong>. If the custom logon page uses automated logins then it must take notice of this parameter to not automatically log the user back in again</p>
</div>
<h3 id="return-messages">Return Messages</h3>
<p>Messages are return to the custom login page using the following query string format
<code>InfoMessages=XXX&amp;AlertMessages=YYY&amp;ErrorMessages=ZZZ</code></p>
<p>Where XXX, YYY and ZZZ are base64 encoded UNICODE strings. Each encoded string contains the messages concatenate with a “|” separator. (see sample app)
These entries will only be in the querystring if there are messages to return.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../nominalvalidation/" title="Nominal Validation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Nominal Validation
              </span>
            </div>
          </a>
        
        
          <a href="../troubleshooting/" title="Troubleshooting" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Troubleshooting
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Proactis Ltd - All Rights Reserved
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.905597d0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>