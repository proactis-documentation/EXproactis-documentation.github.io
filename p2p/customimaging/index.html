



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Technical documentation for the PROACTIS suite of products">
      
      
      
        <meta name="author" content="David Betteridge">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Custom Imaging - Technical Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#fb8c00">
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Arial","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#custom-imaging-dlls" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Technical Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Technical Documentation
              </span>
              <span class="md-header-nav__topic">
                Custom Imaging
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Technical Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="48" height="48">
      
    </a>
    Technical Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Invoice Capture" class="md-nav__link">
      Invoice Capture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Marketplace" class="md-nav__link">
      Marketplace
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      P2P
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        P2P
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../budgetchecking/" title="Budget Checking" class="md-nav__link">
      Budget Checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commitments/" title="Commitment Posting" class="md-nav__link">
      Commitment Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../applicationConfigurationSettings/" title="Application Configuration" class="md-nav__link">
      Application Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../help/" title="Online Help" class="md-nav__link">
      Online Help
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4" checked>
    
    <label class="md-nav__link" for="nav-3-4">
      Imaging Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Imaging Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../genericimaging/" title="Generic Imaging" class="md-nav__link">
      Generic Imaging
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Custom Imaging
      </label>
    
    <a href="./" title="Custom Imaging" class="md-nav__link md-nav__link--active">
      Custom Imaging
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-images" title="Viewing Images" class="md-nav__link">
    Viewing Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hasimage" title="HasImage" class="md-nav__link">
    HasImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimageinfo" title="GetImageInfo" class="md-nav__link">
    GetImageInfo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_1" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_1" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimage" title="GetImage" class="md-nav__link">
    GetImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_2" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_1" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image" title="Image" class="md-nav__link">
    Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url" title="URL" class="md-nav__link">
    URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentdetailsxml" title="DocumentDetailsXML" class="md-nav__link">
    DocumentDetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-images" title="Processing Images" class="md-nav__link">
    Processing Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hasunprocessedimages" title="HasUnprocessedImages" class="md-nav__link">
    HasUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_3" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_2" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getlistofunprocessedimages" title="GetListOfUnprocessedImages" class="md-nav__link">
    GetListOfUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_4" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_3" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimageinfo_1" title="GetImageInfo" class="md-nav__link">
    GetImageInfo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_5" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_2" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_4" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimage_1" title="GetImage" class="md-nav__link">
    GetImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_6" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_3" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image_1" title="Image" class="md-nav__link">
    Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url_1" title="URL" class="md-nav__link">
    URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processimage" title="ProcessImage" class="md-nav__link">
    ProcessImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_7" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentxml" title="DocumentXML" class="md-nav__link">
    DocumentXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usermessages" title="UserMessages" class="md-nav__link">
    UserMessages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml_1" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#searching-for-unprocessed-images" title="Searching for unprocessed images" class="md-nav__link">
    Searching for unprocessed images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#searchforunprocessedimages" title="SearchForUnprocessedImages" class="md-nav__link">
    SearchForUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature" title="Signature" class="md-nav__link">
    Signature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_8" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml_2" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_5" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-images" title="Uploading Images" class="md-nav__link">
    Uploading Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storenewimage" title="StoreNewImage" class="md-nav__link">
    StoreNewImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature_1" title="Signature" class="md-nav__link">
    Signature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_9" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detailsxml_3" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_6" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../invoicePosting/" title="Invoice Posting" class="md-nav__link">
      Invoice Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Import APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Import APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../acceptanceGateway/" title="Acceptances" class="md-nav__link">
      Acceptances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cancelPurhaseOrderGateway/" title="Cancel Purchase Order" class="md-nav__link">
      Cancel Purchase Order
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../expensesGateway/" title="Expenses" class="md-nav__link">
      Expenses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internalInvoiceGateway/" title="Internal Invoices" class="md-nav__link">
      Internal Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../masterData/" title="Master Data" class="md-nav__link">
      Master Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseCreditNoteGateway/" title="Purchase Credit Notes" class="md-nav__link">
      Purchase Credit Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseInvoiceGateway/" title="Purchase Invoices" class="md-nav__link">
      Purchase Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseOrders/" title="Purchase Orders" class="md-nav__link">
      Purchase Orders
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../punchout/" title="PunchOut and Marketplaces" class="md-nav__link">
      PunchOut and Marketplaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nominalvalidation/" title="Nominal Validation" class="md-nav__link">
      Nominal Validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sso/" title="Single Sign On (SSO)" class="md-nav__link">
      Single Sign On (SSO)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-11" type="checkbox" id="nav-3-11">
    
    <label class="md-nav__link" for="nav-3-11">
      Web site customisation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-11">
        Web site customisation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../addins/" title="Addins" class="md-nav__link">
      Addins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../customtab/" title="Custom Tabs" class="md-nav__link">
      Custom Tabs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Source to Contract
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Source to Contract
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/srm/" title="Supplier Management" class="md-nav__link">
      Supplier Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/contracts/" title="Contract Management" class="md-nav__link">
      Contract Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/sourcing/" title="Sourcing" class="md-nav__link">
      Sourcing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/users/" title="Users" class="md-nav__link">
      Users
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-images" title="Viewing Images" class="md-nav__link">
    Viewing Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hasimage" title="HasImage" class="md-nav__link">
    HasImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimageinfo" title="GetImageInfo" class="md-nav__link">
    GetImageInfo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_1" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_1" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimage" title="GetImage" class="md-nav__link">
    GetImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_2" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_1" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image" title="Image" class="md-nav__link">
    Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url" title="URL" class="md-nav__link">
    URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentdetailsxml" title="DocumentDetailsXML" class="md-nav__link">
    DocumentDetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-images" title="Processing Images" class="md-nav__link">
    Processing Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hasunprocessedimages" title="HasUnprocessedImages" class="md-nav__link">
    HasUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_3" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_2" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getlistofunprocessedimages" title="GetListOfUnprocessedImages" class="md-nav__link">
    GetListOfUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_4" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_3" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimageinfo_1" title="GetImageInfo" class="md-nav__link">
    GetImageInfo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_5" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_2" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_4" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getimage_1" title="GetImage" class="md-nav__link">
    GetImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_6" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimetype_3" title="MIMEType" class="md-nav__link">
    MIMEType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image_1" title="Image" class="md-nav__link">
    Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url_1" title="URL" class="md-nav__link">
    URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processimage" title="ProcessImage" class="md-nav__link">
    ProcessImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arguments_7" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentxml" title="DocumentXML" class="md-nav__link">
    DocumentXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usermessages" title="UserMessages" class="md-nav__link">
    UserMessages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml_1" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#searching-for-unprocessed-images" title="Searching for unprocessed images" class="md-nav__link">
    Searching for unprocessed images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#searchforunprocessedimages" title="SearchForUnprocessedImages" class="md-nav__link">
    SearchForUnprocessedImages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature" title="Signature" class="md-nav__link">
    Signature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_8" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailsxml_2" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_5" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-images" title="Uploading Images" class="md-nav__link">
    Uploading Images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storenewimage" title="StoreNewImage" class="md-nav__link">
    StoreNewImage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature_1" title="Signature" class="md-nav__link">
    Signature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_9" title="Arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detailsxml_3" title="DetailsXML" class="md-nav__link">
    DetailsXML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value_6" title="Return Value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/proactis-documentation/ExampleApplications/edit/master/docs/p2p/customimaging.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="custom-imaging-dlls">Custom Imaging DLLs</h1>
<h2 id="overview">Overview</h2>
<p>The PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).</p>
<p>A typical PROACTIS imaging solution requires the following integration points:-</p>
<ol>
<li>The scanned image needs to be associated with an invoice within PROACTIS.</li>
<li>Users need to be able to see the original scanned image by clicking a link within the PROACTIS web site.</li>
</ol>
<p>Although there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customer’s requirements.</p>
<p>For the cases where neither the built-in PROACTIS imaging solution or the Generic Imaging DLLs meet your requirements a completely custom DLL can be written.</p>
<hr />
<h2 id="viewing-images">Viewing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Imaging</strong> which implements the <strong>grsImageIface.IImaging</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>HasImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasimage">HasImage</h3>
<p>Controls if the View Image link is available when looking at a transaction within P2P</p>
<pre class="codehilite"><code class="language-C#">bool IImaging.HasImage(string DocumentDetailsXML)</code></pre>


<h4 id="arguments">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return Value</h4>
<p>The function should return True if an image is available.</p>
<hr />
<h3 id="getimageinfo">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre class="codehilite"><code class="language-C#">int IImaging.GetImageInfo(string DocumentDetailsXML, out string MIMEType)</code></pre>


<h4 id="arguments_1">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_1">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre class="codehilite"><code class="language-c#">bool IImaging.GetImage(string DocumentDetailsXML, out string MIMEType, out byte[] Image, out string URL)</code></pre>


<h4 id="arguments_2">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_1">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="documentdetailsxml">DocumentDetailsXML</h3>
<p>The xml in the DocumentDetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre class="codehilite"><code class="language-xml">&lt;?xml version='1.0'?&gt;&lt;grs:ImagingSettings xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'&gt;
&lt;grs:SessionID&gt;eb89c444-0270-4f06-b8b6-ec0303b00117#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;{D79D1EE8-4B87-414B-8512-92590DFBE2E8}&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;&lt;/grs:ImagingSettings&gt;</code></pre>


<p>The standard fields which are always supplied as:-</p>
<ul>
<li>SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}</li>
<li>DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance </li>
<li>DocumentGUID - GUID to identify the document being displayed</li>
<li>ImageNumber</li>
<li>CompanyGUID - GUID of the company in which the document belongs</li>
</ul>
<p>In the above example the remaining fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr />
<h2 id="processing-images">Processing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Process</strong> which implements the <strong>P2P.grsImageIface.IProcess</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>GetListOfUnprocessedImages</li>
<li>HasUnprocessedImages</li>
<li>ProcessImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasunprocessedimages">HasUnprocessedImages</h3>
<p>Controls if the "Process An Image" link is available from Invoicing home page.</p>
<pre class="codehilite"><code class="language-C#">bool IProcess.HasUnprocessedImages(string DetailsXML)</code></pre>


<h4 id="arguments_3">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_2">Return Value</h4>
<p>The function should return True if one or more images are available for linking to invoices.</p>
<hr />
<h3 id="getlistofunprocessedimages">GetListOfUnprocessedImages</h3>
<p>Returns an XML table showing the list of invoices available for linking</p>
<pre class="codehilite"><code class="language-C#">string IProcess.GetListOfUnprocessedImages(string DetailsXML)</code></pre>


<h4 id="arguments_4">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_3">Return Value</h4>
<p>The function should return XML in the following format</p>
<pre class="codehilite"><code class="language-xml">&lt;?xml version='1.0'?&gt;
&lt;grs:Images xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'&gt;
    &lt;grs:Image grs:Identifier='PINV123.xml'&gt;
        &lt;grs:Fields&gt;
            &lt;grs:Field grs:Name='Column1' grs:Value='Value in column 1' /&gt;
            &lt;grs:Field grs:Name='Column2' grs:Value='Value in column 2' /&gt;
        &lt;/grs:Fields&gt;
    &lt;/grs:Image&gt;
&lt;/grs:Images&gt;</code></pre>


<p>The above table would generate the following table:</p>
<p><img alt="alt text" src="../../img/p2p/imaging/unprocessed.JPG" title="Unprocessed" /></p>
<ul>
<li>There should be one grs:Image element for each scanned image.</li>
<li>The grs:Identifier attribute uniquely identifies the image</li>
<li>Each column required in the table should be added as a grs:Field element</li>
<li>grs:Name provides the caption for the column and grs:Value it's contents.</li>
</ul>
<hr />
<h3 id="getimageinfo_1">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre class="codehilite"><code class="language-C#">int IProcess.GetImageInfo(string DetailsXML, out string MIMEType)</code></pre>


<h4 id="arguments_5">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_2">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_4">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage_1">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre class="codehilite"><code class="language-c#">bool IProcess.GetImage(string DetailsXML, out string MIMEType, out byte[] Image, out string URL)</code></pre>


<h4 id="arguments_6">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_3">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image_1">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url_1">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="processimage">ProcessImage</h3>
<p>Used to associate the image with a document.</p>
<pre class="codehilite"><code class="language-c#">bool IProcess.ProcessImage(string DetailsXML, string DocumentXML, out string UserMessages)</code></pre>


<h4 id="arguments_7">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>DocumentXML</td>
<td>In</td>
<td>The full P2P document which is being linked to the image</td>
</tr>
<tr>
<td>UserMessages</td>
<td>Out</td>
<td>Messages to feed back to the user</td>
</tr>
</tbody>
</table>
<h4 id="detailsxml">DetailsXML</h4>
<p>The DocumentGUID will contain the unique identifier for the selected image.</p>
<h4 id="documentxml">DocumentXML</h4>
<p>The full internal XML for the document this image is being linked with.  The format varies depending on the type of document.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As the internal xml format us undocumented and subject to change it is recommended that you extract as little information as possible and program defensively.</p>
</div>
<h4 id="usermessages">UserMessages</h4>
<p>Allows user message to be returned to the PROACTIS website.  Not normally required.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>This method is responsible for storing the link between the scanned image and the P2P document.  For example the unique ID might be written to the <strong>ImageReference</strong> column in the <strong>dsdba.Invoices</strong> table.</p>
</div>
<hr />
<h3 id="detailsxml_1">DetailsXML</h3>
<p>The xml in the DetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre class="codehilite"><code class="language-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
&lt;grs:SessionID&gt;789e432f-6515-435c-8748-d88665d57119#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;C&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;</code></pre>


<p>The standard fields which are always supplied as:-</p>
<ul>
<li>SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}</li>
<li>DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance </li>
<li>DocumentGUID - GUID to identify the document being displayed</li>
<li>ImageNumber</li>
<li>CompanyGUID - GUID of the company in which the document belongs</li>
</ul>
<p>In the above example the remaining fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr />
<h2 id="searching-for-unprocessed-images">Searching for unprocessed images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Search</strong> which implements the <strong>grsImageIface.ISearch</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>SearchForUnprocessedImages</li>
</ul>
</li>
</ul>
<hr />
<h3 id="searchforunprocessedimages">SearchForUnprocessedImages</h3>
<p>Returns a list of unprocessed images based on the search criteria entered by the user.</p>
<p><img alt="alt text" src="../../img/p2p/imaging/search.JPG" title="Search" /></p>
<h4 id="signature">Signature</h4>
<pre class="codehilite"><code class="language-C#">string ISearch.SearchForUnprocessedImages(string DetailsXML)</code></pre>


<h4 id="arguments_8">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the search criteria .</td>
</tr>
</tbody>
</table>
<h4 id="detailsxml_2">DetailsXML</h4>
<pre class="codehilite"><code class="language-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
    &lt;grs:SessionID&gt;fd2ae334-dd29-42d3-9706-ea4883b7bedc#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
    &lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
    &lt;grs:DocumentGUID&gt;&lt;/grs:DocumentGUID&gt;
    &lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
    &lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;
    &lt;grs:MaxReturnRows&gt;100&lt;/grs:MaxReturnRows&gt;
    &lt;grs:PrimarySortColumn&gt;DocumentDate&lt;/grs:PrimarySortColumn&gt;
    &lt;grs:PrimarySortAscending&gt;False&lt;/grs:PrimarySortAscending&gt;
    &lt;grs:SupplierReference&gt;&lt;/grs:SupplierReference&gt;
    &lt;grs:DateFrom&gt;&lt;/grs:DateFrom&gt;
    &lt;grs:DateTo&gt;&lt;/grs:DateTo&gt;
    &lt;grs:FromAddress&gt;&lt;/grs:FromAddress&gt;
    &lt;grs:ToAddress&gt;&lt;/grs:ToAddress&gt;
    &lt;grs:Subject&gt;&lt;/grs:Subject&gt;
    &lt;grs:RuleName&gt;&lt;/grs:RuleName&gt;
    &lt;grs:DateEmailedFrom&gt;&lt;/grs:DateEmailedFrom&gt;
    &lt;grs:DateEmailedTo&gt;&lt;/grs:DateEmailedTo&gt;

    &lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
    &lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;</code></pre>


<p>The following fields can be ignored as they aren't applicable to this function</p>
<ul>
<li>DocumentGUID</li>
<li>ImageNumber</li>
</ul>
<p>In the above example the following fields come from the <strong>dsdba.ImagingSettings</strong> table</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<h4 id="return-value_5">Return Value</h4>
<p>The function should return xml table in the following format containing the list of available (unprocessed) images.</p>
<pre class="codehilite"><code class="language-xml">&lt;SearchResults&gt;
    &lt;Row GUID='...' 
        SupplierReference='sup' 
        DocumentDate='2016-1-1' 
        DocumentImportRule = ''
        EmailDate='2016-1-1'
        FromAddress='david@proactis.com'
        FromName='David Betteridge'
        Subject='An Email'
        ToAddress='david@proactis.com' /&gt;
&lt;/SearchResults&gt;</code></pre>


<ul>
<li>One row should be added for each unprocessed image</li>
<li>All the attributes listed above must be supplied</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/imaging/search_results.JPG" title="Results" /></p>
<hr />
<h2 id="uploading-images">Uploading Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Upload</strong> which implements the __grsImageIface.IUpload interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>StoreNewImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="storenewimage">StoreNewImage</h3>
<p>Stores an image uploaded by the user on the server</p>
<p><img alt="alt text" src="../../img/p2p/imaging/upload.JPG" title="Upload" /></p>
<h4 id="signature_1">Signature</h4>
<pre class="codehilite"><code class="language-C#">bool IUpload.StoreNewImage(string DetailsXML, byte[] FileContents)</code></pre>


<h4 id="arguments_9">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the image metadata.</td>
</tr>
<tr>
<td>FileContents</td>
<td>In</td>
<td>Contents of the image</td>
</tr>
</tbody>
</table>
<h5 id="detailsxml_3">DetailsXML</h5>
<pre class="codehilite"><code class="language-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
    &lt;grs:DocumentGUID&gt;{7451C54A-52F0-4794-87FB-A6093AAD65AF}&lt;/grs:DocumentGUID&gt;
    &lt;grs:ImageNumber&gt;1&lt;/grs:ImageNumber&gt;

    &lt;grs:SessionID&gt;bd860b98-c82b-47fa-9522-a4f27f154cd6#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
    &lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
    &lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;
    &lt;grs:Reference&gt;heading.JPG&lt;/grs:Reference&gt;
    &lt;grs:FileType&gt;JPG&lt;/grs:FileType&gt;

    &lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
    &lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
    &lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;</code></pre>


<ul>
<li>The DocumentGUID is a unique ID generated for this file</li>
<li>ImageNumber will always be 1</li>
<li>Reference is the name of the uploaded file</li>
<li>DocumentType is I for Invoice and C for Credit Note</li>
</ul>
<p>In the above example the following fields come from the <strong>dsdba.ImagingSettings</strong> table</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<h4 id="return-value_6">Return Value</h4>
<p>Return TRUE for success</p>
<hr />
<h2 id="example">Example</h2>
<p>See the <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Imaging">example application</a> for a complete implementation.</p>
<hr />
<h2 id="deployment">Deployment</h2>
<p>Your dll should be complied (and named xyzImaging.dll) and then copied into your <strong>PROACTIS P2P/Plugins</strong>  (or <strong>Plugins/[database-title]</strong>) folder.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../genericimaging/" title="Generic Imaging" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Generic Imaging
              </span>
            </div>
          </a>
        
        
          <a href="../invoicePosting/" title="Invoice Posting" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Invoice Posting
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Proactis Ltd - All Rights Reserved
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.905597d0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>