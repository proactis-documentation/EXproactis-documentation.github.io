



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Technical documentation for the PROACTIS suite of products">
      
      
      
        <meta name="author" content="David Betteridge">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>PunchOut and Marketplaces - Technical Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#fb8c00">
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Arial","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#punchout" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Technical Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Technical Documentation
              </span>
              <span class="md-header-nav__topic">
                PunchOut and Marketplaces
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Technical Documentation" class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="48" height="48">
      
    </a>
    Technical Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/proactis-documentation/ExampleApplications/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      CodeExamples
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Invoice Capture" class="md-nav__link">
      Invoice Capture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../placeholder/" title="Marketplace" class="md-nav__link">
      Marketplace
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      P2P
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        P2P
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../budgetchecking/" title="Budget Checking" class="md-nav__link">
      Budget Checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commitments/" title="Commitment Posting" class="md-nav__link">
      Commitment Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../applicationConfigurationSettings/" title="Application Configuration" class="md-nav__link">
      Application Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../help/" title="Online Help" class="md-nav__link">
      Online Help
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Imaging Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Imaging Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../genericimaging/" title="Generic Imaging" class="md-nav__link">
      Generic Imaging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../customimaging/" title="Custom Imaging" class="md-nav__link">
      Custom Imaging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../invoicePosting/" title="Invoice Posting" class="md-nav__link">
      Invoice Posting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Import APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Import APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../acceptanceGateway/" title="Acceptances" class="md-nav__link">
      Acceptances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cancelPurhaseOrderGateway/" title="Cancel Purchase Order" class="md-nav__link">
      Cancel Purchase Order
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../expensesGateway/" title="Expenses" class="md-nav__link">
      Expenses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internalInvoiceGateway/" title="Internal Invoices" class="md-nav__link">
      Internal Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../masterData/" title="Master Data" class="md-nav__link">
      Master Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseCreditNoteGateway/" title="Purchase Credit Notes" class="md-nav__link">
      Purchase Credit Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseInvoiceGateway/" title="Purchase Invoices" class="md-nav__link">
      Purchase Invoices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../purchaseOrders/" title="Purchase Orders" class="md-nav__link">
      Purchase Orders
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PunchOut and Marketplaces
      </label>
    
    <a href="./" title="PunchOut and Marketplaces" class="md-nav__link md-nav__link--active">
      PunchOut and Marketplaces
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#punchthro" title="PunchThro." class="md-nav__link">
    PunchThro.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cxml-punchout" title="cXML PunchOut" class="md-nav__link">
    cXML PunchOut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-punchout" title="OCI PunchOut" class="md-nav__link">
    OCI PunchOut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#punchout-customisations" title="PunchOut customisations" class="md-nav__link">
    PunchOut customisations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cxml-handshake" title="cXML Handshake" class="md-nav__link">
    cXML Handshake
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cxml-oci-returned-basket" title="cXML &amp; OCI Returned Basket" class="md-nav__link">
    cXML &amp; OCI Returned Basket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-return-page" title="Custom Return Page" class="md-nav__link">
    Custom Return Page
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nominalvalidation/" title="Nominal Validation" class="md-nav__link">
      Nominal Validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sso/" title="Single Sign On (SSO)" class="md-nav__link">
      Single Sign On (SSO)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-11" type="checkbox" id="nav-3-11">
    
    <label class="md-nav__link" for="nav-3-11">
      Web site customisation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-11">
        Web site customisation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../addins/" title="Addins" class="md-nav__link">
      Addins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../customtab/" title="Custom Tabs" class="md-nav__link">
      Custom Tabs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Source to Contract
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Source to Contract
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/srm/" title="Supplier Management" class="md-nav__link">
      Supplier Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/contracts/" title="Contract Management" class="md-nav__link">
      Contract Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/sourcing/" title="Sourcing" class="md-nav__link">
      Sourcing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../s2c/users/" title="Users" class="md-nav__link">
      Users
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#punchthro" title="PunchThro." class="md-nav__link">
    PunchThro.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cxml-punchout" title="cXML PunchOut" class="md-nav__link">
    cXML PunchOut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-punchout" title="OCI PunchOut" class="md-nav__link">
    OCI PunchOut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#punchout-customisations" title="PunchOut customisations" class="md-nav__link">
    PunchOut customisations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cxml-handshake" title="cXML Handshake" class="md-nav__link">
    cXML Handshake
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cxml-oci-returned-basket" title="cXML &amp; OCI Returned Basket" class="md-nav__link">
    cXML &amp; OCI Returned Basket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-return-page" title="Custom Return Page" class="md-nav__link">
    Custom Return Page
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/proactis-documentation/ExampleApplications/edit/master/docs/p2p/punchout.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="punchout">PunchOut</h1>
<h2 id="overview">Overview</h2>
<p>PunchOut allows a user to jump from the PROACTIS P2P website into a supplier’s shopping site.  Where they can browse a catalogue and add items to a shopping basket as per a normal e-commerce site.  Once they have finished browsing they click checkout and the items are then returned to PROACTIS as new lines on their current purchase order (or requisition).
For the purposes of this document, the term PunchOut does not include the ability to electronically export purchase orders to suppliers in cXML format.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document details how to configure connections to supplier PunchOut sites and marketplaces in the latest release of PROACTIS P2P `17.
Unlike the previous versions it is now possible to configure the connections directly within the product.  Previously the setup action was carried out by a technical consultant which required the coding of bespoke webpages and sometimes DLLs for installation on the P2P server.</p>
</div>
<hr />
<h2 id="punchthro">PunchThro.</h2>
<p>There are three different methods of configuring PunchOut within the PROACTIS P2P product.   This first is referred to as punch-thro.  This is where the buyer connects to the suppliers PunchOut site via the PROACTIS S2C portal. </p>
<p>As the details of the suppliers site are configured in the PROACTIS S2C Portal the only P2P settings required are as shown below</p>
<ul>
<li>Configure the connection to your PROACTIS S2C portal.  (<strong>Application</strong> -&gt; <strong>PROACTIS Connectivity</strong>)</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/punchout/s2c.bmp" title="cxml" /></p>
<ul>
<li>Enable the PunchOut via portal setting against the supplier.</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/punchout/thru-settings.bmp" title="cxml" /></p>
<hr />
<h2 id="cxml-punchout">cXML PunchOut</h2>
<p>The majority of PunchOuts follow the <a href="http://cxml.org/">cXML</a> standard.  This can be configured directly within the P2P product by completing the following fields against a supplier.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/cxml-settings.bmp" title="cxml" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>The values for these 5 fields should be agreed with the supplier however DUNs numbers are often used for the three identities.</li>
<li>The fields can also be edited using the new WebPMC.</li>
</ul>
</div>
<hr />
<h2 id="oci-punchout">OCI PunchOut</h2>
<p>Less commonly used in the UK, but PROACTIS also supports the <a href="https://en.wikipedia.org/wiki/Open_Catalog_Interface">Open Catalog Interface</a> (OCI) PunchOut standard.  Again this can be configured directly within the product by completing the following three fields.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/oci-settings.bmp" title="oci" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The supplier will normally provide you with their URL and your sender identity and secret.</p>
</div>
<hr />
<h2 id="punchout-customisations">PunchOut customisations</h2>
<p>It is possible to customise PunchOut at various points within the process:</p>
<h3 id="cxml-handshake">cXML Handshake</h3>
<p>The format of the cXML sent in the initial connection to the supplier’s site is generated from an XML using an XSLT transformation.  By default PROACTIS uses an XSLT embedded within the product however it is possible to use your own xslt by creating a file within the plugins folder called <strong>PunchoutConnection_{supplierCode}.xslt</strong>.  Where <em>{supplierCode}</em> is the code of your supplier.</p>
<p>The fields which are available to the XSLT are listed below.</p>
<ul>
<li>Context</li>
<li>SessionID</li>
<li>SupplierCode</li>
<li>DepartmentCode</li>
<li>CompanyCode</li>
<li>TemplateLabel</li>
<li>LogonName</li>
<li>ActualName</li>
<li>FirstName</li>
<li>Surname</li>
<li>Email</li>
<li>ReturnURL</li>
<li>URL</li>
<li>BuyerCookie</li>
<li>PayloadID</li>
<li>Timestamp</li>
<li>PunchoutFromIdentity</li>
<li>PunchoutToIdentity</li>
<li>PunchoutSenderIdentity</li>
<li>PunchoutSenderSharedSecret</li>
<li>DeliveryAddressGUID</li>
<li>DeliveryAddressName</li>
<li>DeliveryAddressLine1</li>
<li>DeliveryAddressLine2</li>
<li>DeliveryAddressLine3</li>
<li>DeliveryAddressLine4</li>
<li>DeliveryCountry</li>
<li>DeliveryCounty</li>
<li>DeliveryPostcode</li>
<li>DeliveryPostTown</li>
</ul>
<p>An example XSLT document is available <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Punchout/Connections">here</a>.</p>
<h3 id="cxml-oci-returned-basket">cXML &amp; OCI Returned Basket</h3>
<p>When the basket is returned from the supplier by default it is transformed into the correct P2P format by using an XSLT embedded within the product.  This can be replaced by your own transform by creating a file in the plugins folder called <strong>ReturnedPunchoutBasket_{supplierCode}.xslt</strong> Where <em>{supplierCode}</em> is the code of your supplier.
The XSLT must generate XML in the following format:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;PurchaseOrder&gt;</span>
  <span class="nt">&lt;PurchaseOrderHeader&gt;</span>
    <span class="nt">&lt;SessionID&gt;&lt;/SessionID&gt;</span>
    <span class="nt">&lt;Currency&gt;&lt;/Currency&gt;</span>
    <span class="nt">&lt;TotalValue&gt;&lt;/TotalValue&gt;</span>
  <span class="nt">&lt;/PurchaseOrderHeader&gt;</span>
  <span class="nt">&lt;PunchOutDetail&gt;</span>
    <span class="nt">&lt;Item&gt;</span>
      <span class="nt">&lt;Product&gt;&lt;/Product&gt;</span>
      <span class="nt">&lt;Quantity&gt;&lt;/Quantity&gt;</span>
      <span class="nt">&lt;Description&gt;&lt;/Description&gt;</span>
      <span class="nt">&lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;</span>
      <span class="nt">&lt;UnitValue&gt;&lt;/UnitValue&gt;</span>
      <span class="nt">&lt;Currency&gt;&lt;/Currency&gt;</span>
      <span class="nt">&lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;</span>
      <span class="nt">&lt;Supplier&gt;&lt;/Supplier&gt;</span>
      <span class="nt">&lt;References&gt;</span>
        <span class="nt">&lt;Reference</span> <span class="na">name=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;/Reference&gt;</span>
      <span class="nt">&lt;/References&gt;</span>
    <span class="nt">&lt;/Item&gt;</span>
  <span class="nt">&lt;/PunchOutDetail&gt;</span>
<span class="nt">&lt;/PurchaseOrder&gt;</span>
</pre></div>


<p>An example XSLT document is available <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Punchout/BasketResponses">here</a>.</p>
<h3 id="custom-return-page">Custom Return Page</h3>
<p>By default the supplier posts their basket back to either <strong>PunchoutReturned.aspx</strong> (for cxml) or <strong>PunchoutReturnedOCI.aspx</strong> (for oci).  It is however possible for you to provide your own page for processing the returned basket.  This is configured by completing the following field against the supplier record.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/custom-return.bmp" title="return" /></p>
<p>This page should be placed in the Customer folder within the website.</p>
<p>The default <strong>PunchoutReturned.aspx</strong> page looks for the basket xml in the following form fields:</p>
<ol>
<li>XML</li>
<li>cxml-urlencode</li>
<li>cxml-urlencoded</li>
<li>cXML-base64</li>
<li>oracleCart</li>
<li>the first form field</li>
</ol>
<p>The default <strong>PunchoutReturnedOCI.aspx</strong> page looks for the basket xml in the form fields as follows:</p>
<ol>
<li>The items are returned in arrays of fields.  Indexed from 1 onwards</li>
<li>First it checks there is a field called NEW_ITEM+DESCRIPTION[1].  If there isn’t then it assumes that no basket items were returned.</li>
<li>It then loops through all fields which are named in the format NEW_xxxxx[n] where xxxxx is the name of a property and n is the item number.</li>
<li>Each of these form fields are then added into the xml.  The result xml will have the following format:</li>
</ol>
<div class="codehilite"><pre><span></span><span class="nt">&lt;PurchaseOrder&gt;</span>
    <span class="nt">&lt;line</span> <span class="na">number=</span><span class="s">1</span> <span class="err">item+</span><span class="na">description=</span><span class="s">’red</span> <span class="err">pen’</span> <span class="err">etc</span> <span class="err">etc</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/PurchaseOrder&gt;</span>
</pre></div>


<h1 id="market-place">Market Place</h1>
<p>PROACTIS P2P allows users to connect to a “market place” where they can then browse catalogues of one or more suppliers.  When they have finished browsing and click check-out then their returned basket is used to create one or more draft purchase orders (or requisitions) within PROACTIS.
Unlike previous versions of PROACTIS it is now possible to configure marketplace connections directly within the product.</p>
<h2 id="configuration">Configuration</h2>
<p>Using the “System Control” application choose the Marketplaces option from the Supplier Maintenance menu.  Add a New market place and complete both the Details and PunchOut sections.</p>
<p>The following marketplace types (standards) are currently supported:</p>
<ul>
<li>CXML</li>
<li>PROACTIS EGS</li>
<li>Procserve</li>
<li>Science warehouse</li>
</ul>
<p>The Supplier Code Mapped From field specifies how the supplier code in the returned basket is mapped back to the suppliers within PROACTIS.</p>
<h2 id="customisation">Customisation</h2>
<p>The xml used for the initial connection is generated using an xslt embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called <strong>MarketPlaceConnection_{marketPlaceName}.xslt</strong>.  Where <em>{marketPlaceName}</em> is the name of the configured marketplace. <em>For example MarketPlaceConnection_EGS.xslt</em></p>
<p>The fields passed into the xml are listed below:</p>
<ul>
<li>DepartmentCode</li>
<li>CompanyCode</li>
<li>LogonName</li>
<li>Email</li>
<li>ReturnURL</li>
<li>URL</li>
<li>BuyerCookie</li>
<li>PayloadID</li>
<li>Timestamp</li>
<li>PunchoutFromIdentity</li>
<li>PunchoutToIdentity</li>
<li>PunchoutSenderIdentity</li>
<li>PunchoutSenderSharedSecret</li>
</ul>
<p>When the basket is returned from the market place by default it is transformed into the correct format by using an XSLT embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called <strong>MarketPlaceResult_{marketPlaceName}.xslt</strong>.  Where <em>{marketPlaceName}</em> is the name of the configured marketplace.  <em>For example MarketPlaceResult_EGS.xslt</em></p>
<p>The xslt needs to generate xml in the following format</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;PurchaseOrder&gt;</span>
  <span class="nt">&lt;PurchaseOrderHeader&gt;</span>
    <span class="nt">&lt;SessionID&gt;&lt;/SessionID&gt;</span>
    <span class="nt">&lt;Currency&gt;&lt;/Currency&gt;</span>
    <span class="nt">&lt;TotalValue&gt;&lt;/TotalValue&gt;</span>
  <span class="nt">&lt;/PurchaseOrderHeader&gt;</span>
  <span class="nt">&lt;PunchOutDetail&gt;</span>
    <span class="nt">&lt;Item&gt;</span>
      <span class="nt">&lt;Product&gt;&lt;/Product&gt;</span>
      <span class="nt">&lt;Quantity&gt;&lt;/Quantity&gt;</span>
      <span class="nt">&lt;Description&gt;&lt;/Description&gt;</span>
      <span class="nt">&lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;</span>
      <span class="nt">&lt;UnitValue&gt;&lt;/UnitValue&gt;</span>
      <span class="nt">&lt;Currency&gt;&lt;/Currency&gt;</span>
      <span class="nt">&lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;</span>
      <span class="nt">&lt;Supplier&gt;&lt;/Supplier&gt;</span>
      <span class="nt">&lt;References&gt;</span>
        <span class="nt">&lt;Reference</span> <span class="na">name=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;/Reference&gt;</span>
      <span class="nt">&lt;/References&gt;</span>
    <span class="nt">&lt;/Item&gt;</span>
  <span class="nt">&lt;/PunchOutDetail&gt;</span>
<span class="nt">&lt;/PurchaseOrder&gt;</span>
</pre></div>


<h2 id="troubleshooting">Troubleshooting</h2>
<p>The default XSLTs used for processing the returned baskets may create the following reference fields against the generated items:</p>
<ol>
<li>ContractReference</li>
<li>PartID</li>
</ol>
<p>If however either of these references already exist in <strong>dsdba.CompanyReferences</strong> table but without a category of 'global' then the following error will be reported.</p>
<div class="codehilite"><pre><span></span>There is already a reference of type template with a code of ContractReference. This reference cannot be linked to an item.
</pre></div>


<p>The solution is to either convert the reference field to a global one,  or drop a custom XSLT into the plugins folder which uses a different reference field.</p>
<h2 id="egs-marketplaces">EGS Marketplaces</h2>
<p>The EGS settings within the PROACTIS Connectivity snapin, do not refer to marketplace PunchOut.  This are used to configure different functionality not covered by this document.</p>
<h1 id="proxy-server">Proxy Server</h1>
<p>Connections to both supplier PunchOut, and marketplaces honour the proxy server settings held in the <strong>dsdba.ProxySettings</strong> table.
This can be configured using the System Control application.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../purchaseOrders/" title="Purchase Orders" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Purchase Orders
              </span>
            </div>
          </a>
        
        
          <a href="../nominalvalidation/" title="Nominal Validation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Nominal Validation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; Proactis Ltd - All Rights Reserved
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.905597d0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>